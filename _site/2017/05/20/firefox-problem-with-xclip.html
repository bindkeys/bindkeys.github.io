<!DOCTYPE html>
<!--
    Basically Basic Jekyll Theme 1.2.0
    Copyright 2017-2018 Michael Rose - mademistakes.com | @mmistakes
    Free for personal and commercial use under the MIT license
    https://github.com/mmistakes/jekyll-basically-theme/blob/master/LICENSE.md
-->
<html lang="en-US" class="no-js">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
    
    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Firefox Problem With Xclip | El blog del tecnólogo</title>
<meta name="generator" content="Jekyll v3.7.2" />
<meta property="og:title" content="Firefox Problem With Xclip" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I’ve used both vim and neovim editors. The latter is just the newest implementation with out of the box pre-configurations." />
<meta property="og:description" content="I’ve used both vim and neovim editors. The latter is just the newest implementation with out of the box pre-configurations." />
<link rel="canonical" href="https://bindkeys.github.io/2017/05/20/firefox-problem-with-xclip.html" />
<meta property="og:url" content="https://bindkeys.github.io/2017/05/20/firefox-problem-with-xclip.html" />
<meta property="og:site_name" content="El blog del tecnólogo" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-05-20T13:58:18-05:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://bindkeys.github.io/2017/05/20/firefox-problem-with-xclip.html"},"headline":"Firefox Problem With Xclip","dateModified":"2017-05-20T13:58:18-05:00","datePublished":"2017-05-20T13:58:18-05:00","description":"I’ve used both vim and neovim editors. The latter is just the newest implementation with out of the box pre-configurations.","url":"https://bindkeys.github.io/2017/05/20/firefox-problem-with-xclip.html","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  

  <script>
    /* Cut the mustard */
    if ( 'querySelector' in document && 'addEventListener' in window ) {
      document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + 'js';
    }
  </script>

  <link rel="stylesheet" href="/assets/stylesheets/main.css">
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:400,400i,600,600i">
  

  
    
    <link rel="alternate" type="application/atom+xml" title="El blog del tecnólogo" href="/atom.xml">
  
</head>


  <body class="layout--post firefox-problem-with-xclip">

    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#primary-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>


    <div class="sidebar-toggle-wrapper">
      <button class="toggle navicon-button larr" type="button">
        <span class="toggle-inner">
          <span class="sidebar-toggle-label">Menu</span>
          <span class="navicon"></span>
        </span>
      </button>
    </div>

    <div id="sidebar" class="sidebar">
      <div class="inner">
        <nav id="primary-nav" class="site-nav" itemscope itemtype="http://schema.org/SiteNavigationElement" aria-label="Main navigation">
  <ul id="menu-main-navigation" class="menu">
    <!-- Home link -->
    <li class="menu-item">
      <a href="/" itemprop="url">
        <span itemprop="name">Home</span>
      </a>
    </li>

    <!-- site.pages links -->
    
    

    
      
      
        <li class="menu-item">
          <a href="/about.html" itemprop="url">
            <span itemprop="name">About</span>
          </a>
        </li>
      
    
      
      
    
  </ul>
</nav>

        <ul class="contact-list">
  

  

  

  <li>
    
      <a href="/atom.xml" title="Atom Feed">
        <span class="icon icon--rss"><svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M12.8 16C12.8 8.978 7.022 3.2 0 3.2V0c8.777 0 16 7.223 16 16h-3.2zM2.194 11.61c1.21 0 2.195.985 2.195 2.196 0 1.21-.99 2.194-2.2 2.194C.98 16 0 15.017 0 13.806c0-1.21.983-2.195 2.194-2.195zM10.606 16h-3.11c0-4.113-3.383-7.497-7.496-7.497v-3.11c5.818 0 10.606 4.79 10.606 10.607z"/></svg></span>
        <span class="label">Subscribe</span>
      </a>
    
  </li>
</ul>

      </div>
    </div>

    <div class="canvas">
      <div class="wrapper">
        

<header id="masthead">
  <div class="inner">
    <div class="title-area">
      
        <p class="site-title">
          <a href="/">
            
            <span>El blog del tecnólogo</span>
          </a>
        </p>
      
    </div>
  </div>
</header>

        <header class="intro">
  

  <div class="inner">
    <div class="intro-text">
      <h1 class="intro-title">Firefox Problem With Xclip
</h1>
      

      
        

        <p class="entry-meta">
          <span class="byline-item"><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="379 72 16 16"><g><g><path fill="none" d="M380.8,86.7h12.3v-8.8h-12.3V86.7z M389.5,78.8h1.7v1.4h-1.7V78.8z M389.5,81.3h1.7v1.4h-1.7V81.3z M389.5,83.8h1.7v1.4h-1.7V83.8z M386.1,78.8h1.7v1.4h-1.7V78.8z M386.1,81.3h1.7v1.4h-1.7V81.3z M386.1,83.8h1.7v1.4h-1.7V83.8z M382.8,78.8h1.7v1.4h-1.7V78.8z M382.8,81.3h1.7v1.4h-1.7V81.3z M382.8,83.8h1.7v1.4h-1.7V83.8z"/><polygon fill="none" points="384.7 75.1 383.4 75.1 383.4 74.3 380.8 74.3 380.8 76.6 393.2 76.6 393.2 74.3 390.6 74.3 390.6 75.1 389.3 75.1 389.3 74.3 384.7 74.3"/><rect x="382.8" y="78.8" width="1.7" height="1.4"/><rect x="386.1" y="78.8" width="1.7" height="1.4"/><rect x="389.5" y="78.8" width="1.7" height="1.4"/><rect x="382.8" y="81.3" width="1.7" height="1.4"/><rect x="386.1" y="81.3" width="1.7" height="1.4"/><rect x="389.5" y="81.3" width="1.7" height="1.4"/><rect x="382.8" y="83.8" width="1.7" height="1.4"/><rect x="386.1" y="83.8" width="1.7" height="1.4"/><rect x="389.5" y="83.8" width="1.7" height="1.4"/><path d="M383.4,72v1.1h-3.8V88h14.9V73.1h-3.8V72h-1.3v1.1h-4.7V72H383.4z M393.2,86.7h-12.3v-8.8h12.3L393.2,86.7L393.2,86.7z M389.3,74.3v0.8h1.3v-0.8h2.5v2.3h-12.3v-2.3h2.5v0.8h1.3v-0.8H389.3z"/></g></g></svg></span><time datetime="2017-05-20T13:58:18-05:00">May 20, 2017</time></span> <span class="byline-item"><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="15 309.7 16 16"><g><path d="M23.9 315.1v3.6c0 .5-.4.9-.9.9s-.9-.4-.9-.9v-3.6h1.8z"/><path d="M30.1 317.7c.5 3.9-2.3 7.5-6.2 7.9-3.9.5-7.5-2.3-7.9-6.2-.5-3.9 2.3-7.5 6.2-7.9v-1.8H24v1.8c1.1.1 2.7.7 3.5 1.4l1.3-1.3 1.3 1.3-1.3 1.3c.5.9 1.2 2.5 1.3 3.5zm-1.8.9c0-2.9-2.4-5.3-5.3-5.3s-5.3 2.4-5.3 5.3 2.4 5.3 5.3 5.3 5.3-2.3 5.3-5.3z"/></g></svg></span>3 min read</span>
        </p>
      

      

      
    </div>
  </div>
</header>


<main id="main" class="page-content" aria-label="Content">
  <div class="inner">
    <article class="entry-wrap">
      <div class="entry-content">
        <p>I’ve used both vim and neovim editors. The latter is just the newest implementation with out of the box pre-configurations.</p>

<p>As expected, whenever I was trying to use the copy paste command tool such as <code>xclip</code>, both vim and neovim produced the newlines on the X window system across different applications.</p>

<p>But when I set out to write an email on Gmail from Alphabet Inc., using a copy paste command tool such as <a href="https://github.com/astrand/xclip" target="_blank">xclip</a>, the process was to no avail: newlines were not being displayed on Gmail’s interface.</p>

<p>The closest match was a 2016 <a href="https://github.com/neovim/neovim/issues/4501" target="_blank">Yanking to clipboard does not preserve newlines (when pasting to some applications</a> issue that was opened but was eventually closed because the user decided to have <code>xsel</code> take care of the problem for him/her.</p>

<p>But that post raised more questions than answers.</p>

<p>There was a reference on that thread about seeing a post on unix.stackexchange.com:
<a href="http://unix.stackexchange.com/questions/164074/pasting-in-thunderbird-turns-line-breaks-into-spaces">http://unix.stackexchange.com/questions/164074/pasting-in-thunderbird-turns-line-breaks-into-spaces</a></p>

<p>After reading the link provided, I recall having come across the same post hours earlier when I was trying to find out more about the issue. A Google search with keywords including but not limited to <strong>xclip</strong> or <strong>newlines</strong>, or <strong>gmail</strong> or <strong>firefox</strong> would return as one of the first results, that specific post which appeared on the stackexchange network before any other post and more relevant results would showed up. Perhaps even those that were more important queries on the web were relegated, but I guess that’s an entirely different issue.</p>

<p>The answer that was accepted on the stackexchange network for that particular question did nothing to resolve the problem, and I guess it wasn’t until I came across the outstanding bugs on Firefox as I will show later, that the buried comment by a user name Volker Siegel was more relevant than I thought:</p>

<blockquote>
<p>Wow. I indeed was using html. Turning this off solved the problem. What could
be an explanation for that? – user2820379 Apr 28 ‘15 at 8:18</p>

<p>Explanation? “Thunderbird, a software that has evolved over more than a decade
to follow changes in protocols and UI expectations. Under these circumstances,
it is inevitable that the structure degrades - know as bit rot. In this
context, it is hard to introduce a new feature in conflict with the current
state, when solving the conflict is infeasible. A new UI feature like HTML
editing may need to be sneaked in between rotten skeletons of old protocol
layers. It will work nicely, but as a result, you will find the configuration
of the new feature down between these old rotten sediments.” – Volker Siegel
Apr 28 ‘15 at 15:30</p>
</blockquote>

<p>I wanted to get at the reasoning behind this fiasco and whether to blame neovim or gmail for it.
On vim: pasting worked under the Gmail’s interface, whereas with neovim the process just failed: newlines turned into whitespace.</p>

<p>The bug is one of those outstanding and hence unresolved that for years has plagued the Firefox browser and its counterpart such as Firebird:</p>

<p><img src="/images/firefox_bug_newlines.png" alt="Paste in content editable div from xclip removes newlines" /></p>

<p><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1049785" target="_blank">Paste in contentEditable div from xclip removes newlines</a></p>

<p>The above post made a reference to <a href="https://productforums.google.com/forum/#!msg/gmail/aV8bdPFiR24/3Owwd9rSaD0J" target="_blank">Gmail ignoring newlines on Copy/Paste</a> and the unhelpful answer of a user did nothing to pinpoint at the problem:</p>

<p><img src="/images/gmail_ignoring_newlines_copypaste.png" alt="gmail ignoring newlines" /></p>

<p>The ludicrous implementation of <code>\r</code> before <code>\n</code> is just nonsense.</p>

<p>And it also does not matter whether <code>printf</code> was used instead or a simple <code>echo</code>:</p>

<pre><code> $ echo -e 'una prueba\npara ver' | xclip -sel c 
</code></pre>

<p>or</p>

<pre><code> $ echo $'una prueba\npara ver' | xclip -sel c 
</code></pre>

<p>With <code>xsel</code> the flags are entirely different. But this clearly showed that Firefox is still trying to catch up with it. Gmail is not the problem. If it were I’d be more than happy to denote it. One could verify it by using a different email service such as Outlook from Microsoft for example.</p>

<p>A quick search related to Firefox turned out many more issues than what was originally intended, such as <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1174452" target="_blank">Copying text with the style “white-space: pre;” does not preserve white space (spaces, tabs, newlines)</a></p>

<p>On the above thread, an <a href="https://bug1174452.bmoattachments.org/attachment.cgi?id=8646518" target="_blank">attachment</a> provided can also be verified with <code>xclip</code>. It does not work under Firefox.</p>

<p>Another <a href="https://kb.iu.edu/d/bdkf">bug 116083</a> is still on the database for the Indiana University.</p>

<p><strong>References</strong></p>

<p><a href="https://specifications.freedesktop.org/clipboards-spec/clipboards-latest.txt" target="_blank">Clipboard specifications from freedesktop.org</a></p>

      </div>
      
    </article>

    <footer id="footer" class="site-footer">
  <div class="copyright">
    
      <p>&copy; 2018 El blog del tecnólogo.</p>
    
  </div>
</footer>

  </div>
</main>

      </div>
    </div>

    

<script async src="/assets/javascripts/main.js"></script>

  </body>

</html>
